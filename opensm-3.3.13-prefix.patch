diff -up opensm-3.3.17/man/opensm.8.in.prefix opensm-3.3.17/man/opensm.8.in
--- opensm-3.3.17/man/opensm.8.in.prefix	2014-01-29 15:50:51.000000000 -0500
+++ opensm-3.3.17/man/opensm.8.in	2014-06-17 12:35:29.993235159 -0400
@@ -11,6 +11,7 @@ opensm \- InfiniBand subnet manager and
 [\-g(uid) <GUID in hex>]
 [\-l(mc) <LMC>]
 [\-p(riority) <PRIORITY>]
+[\-\-subnet_prefix <PREFIX in hex>]
 [\-\-smkey <SM_Key>]
 [\-\-sm_sl <SL number>]
 [\-r(eassign_lids)]
@@ -135,6 +136,13 @@ This will effect the handover cases, whe
 is chosen by priority and GUID.  Range goes from 0
 (default and lowest priority) to 15 (highest).
 .TP
+\fB\-\-subnet_prefix\fR <PREFIX in hex>
+This option specifies the subnet prefix to use on the fabric.
+The default prefix is 0xfe80000000000000.  OpenMPI in particular
+requires that separate fabrics plugged into different ports on
+a machine must have different subnet prefixes in order to
+identify that it is not two ports plugged into a single fabric.
+.TP
 \fB\-\-smkey\fR <SM_Key value>
 This option specifies the SM\'s SM_Key (64 bits).
 This will effect SM authentication.
diff -up opensm-3.3.17/opensm/main.c.prefix opensm-3.3.17/opensm/main.c
--- opensm-3.3.17/opensm/main.c.prefix	2014-01-29 15:50:51.000000000 -0500
+++ opensm-3.3.17/opensm/main.c	2014-06-17 12:38:08.897747800 -0400
@@ -160,6 +160,9 @@ static void show_usage(void)
 	       "          This will effect the handover cases, where master\n"
 	       "          is chosen by priority and GUID.  Range goes\n"
 	       "          from 0 (lowest priority) to 15 (highest).\n\n");
+	printf("--subnet_prefix <prefix>\n"
+	       "          Set the subnet prefix to something other than the\n"
+	       "          default value of 0xfe80000000000000\n\n");
 	printf("--smkey, -k <SM_Key>\n"
 	       "          This option specifies the SM's SM_Key (64 bits).\n"
 	       "          This will effect SM authentication.\n"
@@ -690,6 +693,7 @@ int main(int argc, char *argv[])
 		{"log_prefix", 1, NULL, 9},
 		{"torus_config", 1, NULL, 10},
 		{"guid_routing_order_no_scatter", 0, NULL, 13},
+		{"subnet_prefix", 1, NULL, 15},
 		{NULL, 0, NULL, 0}	/* Required at the end of the array */
 	};
 
@@ -1139,6 +1143,10 @@ int main(int argc, char *argv[])
 		case 13:
 			opt.guid_routing_order_no_scatter = TRUE;
 			break;
+		case 15:
+			opt.subnet_prefix = cl_hton64(strtoull(optarg, NULL, 16));
+			printf(" Subnet_Prefix = <0x%" PRIx64 ">\n", cl_hton64(opt.subnet_prefix));
+			break;
 		case 'h':
 		case '?':
 		case ':':
